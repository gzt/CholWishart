<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cholesky Decomposition of the Wishart Distribution • CholWishart</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Cholesky Decomposition of the Wishart Distribution">
<meta property="og:description" content="Sampling from the Cholesky factorization of a Wishart random variable, sampling from the inverse Wishart distribution, sampling from the Cholesky factorization of an inverse Wishart random variable, sampling from the pseudo Wishart distribution, sampling from the generalized inverse Wishart distribution, computing densities for the Wishart and inverse Wishart distributions, and computing the multivariate gamma and digamma functions. Provides a header file so the C functions can be called directly from other programs.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CholWishart</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/wishart.html">Some Distributions Related to the Wishart</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/CholWishart/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">


<hr>
<p><a href="https://cran.r-project.org/" class="external-link"><img src="https://img.shields.io/badge/R%3E%3D-3.6.2-6666ff.svg" alt="minimal R version"></a> <a href="https://cran.r-project.org/package=CholWishart" class="external-link"><img src="http://www.r-pkg.org/badges/version/CholWishart" alt="CRAN_Status_Badge"></a> <a href="https://github.com/gzt/CholWishart/releases" class="external-link"><img src="https://img.shields.io/badge/Package%20version-1.1.4-orange.svg?style=flat-square" alt="packageversion"></a> <!-- badges: end --></p>
<hr>
<p><a href="https://github.com/gzt/CholWishart/" class="external-link"><img src="https://img.shields.io/badge/last%20change-2024--09--29-yellowgreen.svg" alt="Last-changedate"></a></p>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div class="section level1">
<div class="page-header"><h1 id="cholwishart">CholWishart<a class="anchor" aria-label="anchor" href="#cholwishart"></a>
</h1></div>
<p>The most common use for this package is likely fast sampling from the inverse Wishart or use of the multivariate gamma or digamma functions. This is a package for fast computation of various functions related to the Wishart distribution, such as sampling from the Cholesky factorization of the Wishart, sampling from the inverse Wishart, sampling from the Cholesky factorization of the inverse Wishart, sampling from the pseudo Wishart, computing densities for the Wishart and inverse Wishart, and computing a few auxiliary functions such as the multivariate gamma and digamma functions. Many of these functions are written in C to maximize efficiency.</p>
<p>The output of the sampling functions is in the same format as the output of <code><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">stats::rWishart()</a></code>.</p>
<p>The main idea: sampling for multivariate or matrix variate statistics often makes use of distributions related to the Wishart. There are implementations in a few packages but they are often in R and much slower than the basic <code><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">stats::rWishart()</a></code> or there is a lot of associated overhead in the package. Here, then, is a small package with some of those distributions and related functions. As the name suggests, the initial purpose was sampling from the Cholesky factorization of a Wishart distribution.</p>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<p>The package offers the following distributions:</p>
<ul>
<li>The inverse Wishart:</li>
</ul>
<!-- --><div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rInvWishart</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">5</span>,<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">4</span>))<span class="er">)</span></span></code></pre></div>
<ul>
<li>The Cholesky decomposition of the inverse Wishart:</li>
</ul>
<!-- --><div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">rInvCholWishart</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">5</span>,<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">4</span>))<span class="er">)</span></span></code></pre></div>
<ul>
<li>The Cholesky decomposition of the Wishart</li>
</ul>
<!-- --><div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">rCholWishart</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">5</span>,<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">4</span>))<span class="er">)</span></span></code></pre></div>
<ul>
<li>The pseudo Wishart and its pseudo-inverse, the generalized inverse Wishart (<code>df</code> less than the dimension of <code>Sigma</code> minus 1):</li>
</ul>
<!-- --><div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">rPseudoWishart</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">3</span>,<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">5</span>))<span class="er">)</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">rGenInvWishart</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">df =</span> <span class="dv">3</span>,<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">5</span>))<span class="er">)</span></span></code></pre></div>
<ul>
<li>The package also offers density functions for the Wishart and inverse Wishart distributions:</li>
</ul>
<!-- --><div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">dInvWishart</span>(<span class="at">x =</span> <span class="fu">diag</span>(<span class="dv">4</span>), <span class="at">df =</span> <span class="dv">5</span>, <span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">4</span>), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">dWishart</span>(<span class="at">x =</span> <span class="fu">diag</span>(<span class="dv">4</span>), <span class="at">df =</span> <span class="dv">5</span>, <span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">4</span>), <span class="at">log =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>In addition to this, the package offers the multivariate gamma function and multivariate digamma function, the multivariate counterparts of the gamma and digamma (derivative of the log of the gamma) functions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">mvgamma</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">p =</span> <span class="dv">3</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">mvdigamma</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">p =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>I suspect the most useful functions for most people will be the <code>mvgamma</code> and <code>rInvWishart</code> functions.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>Now available on CRAN, install it at:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'CholWishart'</span>)</span></code></pre></div>
<p>Install the latest development version at:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># install.packages('devtools')</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"gzt/CholWishart"</span>)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="calling-from-other-packages">Calling from other packages<a class="anchor" aria-label="anchor" href="#calling-from-other-packages"></a>
</h1>
<p>The header <code>inst/install/CholWishart.h</code> is available so that the exported functions can be called in C from other packages.</p>
</div>
<div class="section level1">
<h1 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h1>
<p>Please note that the ‘CholWishart’ project is released with a <a href="https://gzt.github.io/CholWishart/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=CholWishart" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/gzt/CholWishart/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/gzt/CholWishart/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=3)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CholWishart</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Geoffrey Thompson <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2436-8822" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://codecov.io/gh/gzt/CholWishart" class="external-link"><img src="https://codecov.io/gh/gzt/CholWishart/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://github.com/gzt/CholWishart/actions" class="external-link"><img src="https://github.com/gzt/CholWishart/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html" class="external-link"><img src="https://img.shields.io/badge/licence-GPL--3-blue.svg" alt="Licence"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="lifecycle"></a></li>
<li><a href="https://cran.r-project.org/package=CholWishart" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/CholWishart"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
