<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Some Distributions Related to the Wishart • CholWishart</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Some Distributions Related to the Wishart">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CholWishart</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/wishart.html">Some Distributions Related to the Wishart</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/CholWishart/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Some Distributions Related to the Wishart</h1>
                        <h4 data-toc-skip class="author">Geoffrey
Thompson</h4>
            
            <h4 data-toc-skip class="date">2024-09-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/CholWishart/blob/master/vignettes/wishart.Rmd" class="external-link"><code>vignettes/wishart.Rmd</code></a></small>
      <div class="hidden name"><code>wishart.Rmd</code></div>

    </div>

    
    
<p>The <code>stats</code> implementation of <code>rWishart</code> is in
<code>C</code> and is very fast. It is often the case that we do not
want a sample from the Wishart distribution, but rather from the inverse
of it or from the Cholesky decomposition of a sample from the Wishart
distribution. Or even from the inverse of the Cholesky decomposition of
a draw from the Wishart distribution. Funnily enough (if you have a
weird sense of humor), when you inspect the <a href="https://github.com/SurajGupta/r-source/blob/master/src/library/stats/src/rWishart.c" class="external-link">source
code</a> for the <code>rWishart</code> distribution (<span class="citation">R Core Team (2017)</span>), it generates the Cholesky
decomposition and then multiplies it out. Meanwhile, drawing from the
<code>rWishart</code> and then inverting or doing a Cholesky
decomposition or whatever in R is just slow – comparatively.</p>
<p>This suggests some obvious efficiencies: perhaps, if we would rather
have the Cholesky decomposition of the Wishart random matrix, we could
tell the function to stop right there.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/gzt/CholWishart" class="external-link">'CholWishart'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180220</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">rWishart</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180220</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rInvWishart.html">rInvWishart</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180220</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rCholWishart.html">rCholWishart</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180220</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rInvCholWishart.html">rInvCholWishart</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="how-the-wishart-distribution-works">How the Wishart distribution works<a class="anchor" aria-label="anchor" href="#how-the-wishart-distribution-works"></a>
</h3>
<p>Suppose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>∼</mo><mi>M</mi><mi>V</mi><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>Σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_i \sim MVN(0, \Sigma)</annotation></semantics></math>
are independent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-variate
normal random variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">i = 1, 2, \ldots n</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n &gt; p-1</annotation></semantics></math>.
Then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo>∑</mo><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S = \sum X_i^T X_i</annotation></semantics></math>,
called the “scatter matrix”, is almost surely positive definite if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Σ</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
is positive definite. The random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is said to be distributed as a Wishart random variable:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∼</mo><msub><mi>W</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>,</mo><mi>Σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S \sim W_p(n, \Sigma)</annotation></semantics></math>,
see <span class="citation">Gupta and Nagar (1999)</span>. This can be
extended to the non-integer case as well.</p>
<p>How does <code>rWishart(n, df, Sigma)</code> work (supposing
<code>Sigma</code> is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p \times p</annotation></semantics></math>
matrix)? First, it generates a sample from the Cholesky decomposition of
a Wishart distribution with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Σ</mi><mo>=</mo><msub><mi>𝐈</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\Sigma = \mathbf{I}_p</annotation></semantics></math>.
How this is done: on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
element of the main diagonal, draw from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><msubsup><mi>χ</mi><mrow><mi>p</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></msubsup></msqrt><annotation encoding="application/x-tex">\sqrt{\chi_{p-i+1}^2}</annotation></semantics></math>.
On the upper triangle of the matrix, sample from an independent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math>
for each entry in the matrix. Then, this can be multiplied by the
Cholesky decomposition of the provided <code>Sigma</code> to obtain the
Cholesky factor of the desired sample from the Wishart random variable
(this construction is due to Bartlett and is also known as the Bartlett
Decomposition) (see <span class="citation">Anderson (1984)</span>). The
<code>rWishart</code> function multiplies this out. Therefore, if the
Cholesky decomposition is desired, one only needs to stop there.</p>
</div>
<div class="section level3">
<h3 id="the-inverse-wishart-distribution">The Inverse Wishart distribution<a class="anchor" aria-label="anchor" href="#the-inverse-wishart-distribution"></a>
</h3>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∼</mo><msub><mtext mathvariant="normal">W</mtext><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ν</mi><mo>,</mo><mi>Σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X \sim \textrm{W}_p(\nu,\Sigma)</annotation></semantics></math>,
then we define the Inverse Wishart as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>Y</mi><mo>∼</mo><msub><mtext mathvariant="normal">IW</mtext><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ν</mi><mo>,</mo><msup><mi>Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X^{-1}  = Y \sim \textrm{IW}_p(\nu , \Sigma^{-1})</annotation></semantics></math>.
There are other parameterizations of the distribution, mostly coming
down to different ways of writing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
parameter - be aware of this when using any package drawing from the
Inverse Wishart distribution (see <span class="citation">Dawid
(1981)</span> for an alternative; this presentation follows <span class="citation">Gupta and Nagar (1999)</span>). This comes up directly
in Bayesian statistics. We are also interested in the Cholesky
decomposition of this, as it is required in the generation of the matrix
variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution.
In this package it is done by taking the covariance matrix, inverting
it, computing the Cholesky decomposition of the inverted covariance
matrix, drawing the Cholesky factor of a Wishart matrix using that, and
then inverting based on that (as finding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">\Psi^{-1}</annotation></semantics></math>
given the Cholesky factorization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
is relatively fast). This can then be converted into the Cholesky factor
of the Inverse Wishart if that is what is desired. This would be slow to
do in R, but in C it is not so bad.</p>
<p>Here is what happens with the results of the above:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">B</span> </span>
<span><span class="co">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span><span class="co">## [1,]  1.000000e+00  8.976532e-17 -1.256786e-16 -6.985020e-17</span></span>
<span><span class="co">## [2,] -6.179054e-16  1.000000e+00  9.857855e-17 -9.551455e-17</span></span>
<span><span class="co">## [3,] -2.371165e-16 -9.684781e-17  1.000000e+00  9.102991e-18</span></span>
<span><span class="co">## [4,]  1.388748e-16 -9.861383e-17 -3.128188e-17  1.000000e+00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="co"># note: we do not expect C = D^-1, we expect this! </span></span>
<span><span class="co">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span><span class="co">## [1,]  1.000000e+00  8.976532e-17 -1.256786e-16 -6.985020e-17</span></span>
<span><span class="co">## [2,] -6.179054e-16  1.000000e+00  9.857855e-17 -9.551455e-17</span></span>
<span><span class="co">## [3,] -2.371165e-16 -9.684781e-17  1.000000e+00  9.102991e-18</span></span>
<span><span class="co">## [4,]  1.388748e-16 -9.861383e-17 -3.128188e-17  1.000000e+00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">A</span></span>
<span><span class="co">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span><span class="co">## [1,]  1.000000e+00 -6.179054e-16 -2.371165e-16  1.388748e-16</span></span>
<span><span class="co">## [2,]  8.976532e-17  1.000000e+00 -9.684781e-17 -9.861383e-17</span></span>
<span><span class="co">## [3,] -1.256786e-16  9.857855e-17  1.000000e+00 -3.128188e-17</span></span>
<span><span class="co">## [4,] -6.985020e-17 -9.551455e-17  9.102991e-18  1.000000e+00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">B</span></span>
<span><span class="co">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span><span class="co">## [1,]  1.000000e+00  8.976532e-17 -1.256786e-16 -6.985020e-17</span></span>
<span><span class="co">## [2,] -6.179054e-16  1.000000e+00  9.857855e-17 -9.551455e-17</span></span>
<span><span class="co">## [3,] -2.371165e-16 -9.684781e-17  1.000000e+00  9.102991e-18</span></span>
<span><span class="co">## [4,]  1.388748e-16 -9.861383e-17 -3.128188e-17  1.000000e+00</span></span></code></pre></div>
<p>There is some roundoff error.</p>
</div>
<div class="section level3">
<h3 id="the-pseudo-wishart-and-generalized-inverse-wishart">The Pseudo-Wishart and Generalized Inverse Wishart<a class="anchor" aria-label="anchor" href="#the-pseudo-wishart-and-generalized-inverse-wishart"></a>
</h3>
<p>Suppose, instead of the above definition of the Wishart, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≤</mo><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \leq p-1</annotation></semantics></math>.
Then the scatter matrix defined above will not be positive definite.
This is called the pseudo Wishart distribution. If we then take the
Moore-Penrose pseudo-inverse of this, we have the generalized inverse
Wishart distribution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPseudoWishart.html">rPseudoWishart</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, df <span class="op">=</span> <span class="fl">3</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">A</span></span>
<span><span class="co">##            [,1]       [,2]       [,3]       [,4]       [,5]</span></span>
<span><span class="co">## [1,]  1.9553698  0.3134085 -0.8487259 -0.5174803  0.7487007</span></span>
<span><span class="co">## [2,]  0.3134085  2.3856728 -0.6106572  1.4471373  1.5976931</span></span>
<span><span class="co">## [3,] -0.8487259 -0.6106572  0.5838199 -0.7509533 -0.7863404</span></span>
<span><span class="co">## [4,] -0.5174803  1.4471373 -0.7509533  4.8520003  1.6696925</span></span>
<span><span class="co">## [5,]  0.7487007  1.5976931 -0.7863404  1.6696925  1.4396817</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rGenInvWishart.html">rGenInvWishart</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, df <span class="op">=</span> <span class="fl">3</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">B</span></span>
<span><span class="co">##             [,1]         [,2]        [,3]         [,4]        [,5]</span></span>
<span><span class="co">## [1,]  0.33422500  0.189387794  0.07086651 -0.052283855 -0.04241885</span></span>
<span><span class="co">## [2,]  0.18938779  0.155647000 -0.02450637  0.001357582 -0.07549583</span></span>
<span><span class="co">## [3,]  0.07086651 -0.024506366  0.10489215 -0.052325490  0.03515182</span></span>
<span><span class="co">## [4,] -0.05228386  0.001357582 -0.05232549  0.028056042 -0.02793470</span></span>
<span><span class="co">## [5,] -0.04241885 -0.075495830  0.03515182 -0.027934699  0.24217199</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span></span>
<span><span class="co">## [1] 3</span></span></code></pre></div>
<p>Note that the rank of both of these matrices is less than the
dimension.</p>
</div>
<div class="section level3">
<h3 id="density-computation">Density computation<a class="anchor" aria-label="anchor" href="#density-computation"></a>
</h3>
<p>This package also has functions for density computations with the
Wishart distribution. Densities are only defined for positive-definite
input matrices and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
parameters larger than the dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.</p>
<p>The return value is on the <code>log</code> scale but it can be
specified otherwise.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dWishart.html">dWishart</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">5</span>, <span class="fl">5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -19.45038</span></span>
<span></span>
<span><span class="fu"><a href="../reference/dWishart.html">dInvWishart</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">5</span>, <span class="fl">.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -19.45038</span></span></code></pre></div>
<p>Note that, in general, these will not agree even if their covariance
matrix parameters are inverses of each other. One of the reasons this
works is that the determinant of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.</p>
<p>The density functions can take 3-D array input indexed on the third
dimension and will output a vector of densities.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180311</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">rWishart</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, df <span class="op">=</span> <span class="fl">3</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dWishart.html">dWishart</a></span><span class="op">(</span><span class="va">A</span>, df <span class="op">=</span> <span class="fl">3</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -13.070275  -8.879220  -8.555529</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a>
</h3>
<p>The multivariate gamma
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Γ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\Gamma_p</annotation></semantics></math>)
and digamma
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\psi_p</annotation></semantics></math>)
functions are extensions of the univariate gamma
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>)
and digamma
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>)
functions (<span class="citation">Mardia, Bibby, and Kent
(1982)</span>). They are useful in calculating the densities above. They
come up in other distributions as well. The digamma is the first
derivative of the gamma function. When the dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p = 1</annotation></semantics></math>,
they coincide with the usual definitions of the digamma and gamma
functions.</p>
<p>The multivariate gamma also comes in a logarithmic form
(<code>lmvgamma</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmvgamma.html">lmvgamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># note how they agree when p = 1</span></span>
<span><span class="co">## [1] 0.0000000 0.0000000 0.6931472 1.7917595</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">lgamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.0000000 0.0000000 0.6931472 1.7917595</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Anderson84a" class="csl-entry">
Anderson, T. W., ed. 1984. <em>An Introduction to Multivariate
Statistical Analysis</em>. Wiley.
</div>
<div id="ref-dawid" class="csl-entry">
Dawid, A. P. 1981. <span>“Some Matrix-Variate Distribution Theory:
Notational Considerations and a Bayesian Application.”</span>
<em>Biometrika</em> 68 (1): 265–74. <a href="http://www.jstor.org/stable/2335827" class="external-link">http://www.jstor.org/stable/2335827</a>.
</div>
<div id="ref-gupta1999matrix" class="csl-entry">
Gupta, A. K., and D. K. Nagar. 1999. <em>Matrix Variate
Distributions</em>. Monographs and Surveys in Pure and Applied
Mathematics. Taylor &amp; Francis. <a href="https://books.google.com/books?id=PQOYnT7P1loC" class="external-link">https://books.google.com/books?id=PQOYnT7P1loC</a>.
</div>
<div id="ref-mardia1982multivariate" class="csl-entry">
Mardia, K. V., J. M. Bibby, and J. T. Kent. 1982. <em>Multivariate
Analysis</em>. Probability and Mathematical Statistics. Acad. Press. <a href="https://books.google.com/books?id=1nLonQEACAAJ" class="external-link">https://books.google.com/books?id=1nLonQEACAAJ</a>.
</div>
<div id="ref-rstatsteam" class="csl-entry">
R Core Team. 2017. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
