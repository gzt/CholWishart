<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Random Generalized Inverse Wishart Distributed Matrices — rGenInvWishart • CholWishart</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Random Generalized Inverse Wishart Distributed Matrices — rGenInvWishart" />

<meta property="og:description" content="Generate n random matrices, distributed according
    to the generalized inverse Wishart distribution with parameters
    Sigma and df, \(W_p(\Sigma, df)\),
    with sample size df less than the dimension p.
Let \(X_i\), \(i = 1, 2, ..., df\) be df
    observations of a multivariate normal distribution with mean 0 and
    covariance Sigma. Then \(\sum X_i X_i'\) is distributed as a pseudo
    Wishart \(W_p(\Sigma, df)\). Sometimes this is called a
    singular Wishart distribution, however, that can be confused with the case
    where \(\Sigma\) itself is singular. Then the generalized inverse
    Wishart distribution is the natural extension of the inverse Wishart using
    the Moore-Penrose pseudo-inverse. This can generate samples for positive
    semi-definite \(\Sigma\) however, a function dedicated to generating
    singular normal random distributions or singular pseudo Wishart distributions
    should be used if that is desired.
Note there are different ways of parameterizing the Inverse
    Wishart distribution, so check which one you need.
    Here,  If \(X \sim IW_p(\Sigma, \nu)\) then
    \(X^{-1} \sim W_p(\Sigma^{-1}, \nu)\).
    Dawid (1981) has a different definition: if
    \(X \sim W_p(\Sigma^{-1}, \nu)\) and
    \(\nu &amp;gt; p - 1\), then
    \(X^{-1} = Y \sim IW(\Sigma, \delta)\), where
    \(\delta = \nu - p + 1\)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CholWishart</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wishart.html">Some Distributions Related to the Wishart</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gzt/CholWishart">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Random Generalized Inverse Wishart Distributed Matrices</h1>
    <small class="dont-index">Source: <a href='https://github.com/gzt/CholWishart/blob/master/R/wishart.R'><code>R/wishart.R</code></a></small>
    <div class="hidden name"><code>rGenInvWishart.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Generate n random matrices, distributed according
    to the generalized inverse Wishart distribution with parameters
    <code>Sigma</code> and <code>df</code>, \(W_p(\Sigma, df)\),
    with sample size <code>df</code> less than the dimension <code>p</code>.</p>
<p>Let \(X_i\), \(i = 1, 2, ..., df\) be <code>df</code>
    observations of a multivariate normal distribution with mean 0 and
    covariance <code>Sigma</code>. Then \(\sum X_i X_i'\) is distributed as a pseudo
    Wishart \(W_p(\Sigma, df)\). Sometimes this is called a
    singular Wishart distribution, however, that can be confused with the case
    where \(\Sigma\) itself is singular. Then the generalized inverse
    Wishart distribution is the natural extension of the inverse Wishart using
    the Moore-Penrose pseudo-inverse. This can generate samples for positive
    semi-definite \(\Sigma\) however, a function dedicated to generating
    singular normal random distributions or singular pseudo Wishart distributions
    should be used if that is desired.</p>
<p>Note there are different ways of parameterizing the Inverse
    Wishart distribution, so check which one you need.
    Here,  If \(X \sim IW_p(\Sigma, \nu)\) then
    \(X^{-1} \sim W_p(\Sigma^{-1}, \nu)\).
    Dawid (1981) has a different definition: if
    \(X \sim W_p(\Sigma^{-1}, \nu)\) and
    \(\nu &gt; p - 1\), then
    \(X^{-1} = Y \sim IW(\Sigma, \delta)\), where
    \(\delta = \nu - p + 1\).</p>
    
    </div>

    <pre class="usage"><span class='fu'>rGenInvWishart</span>(<span class='no'>n</span>, <span class='no'>df</span>, <span class='no'>Sigma</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>integer sample size.</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>integer parameter, "degrees of freedom", should be less than the
dimension of <code>p</code></p></td>
    </tr>
    <tr>
      <th>Sigma</th>
      <td><p>positive semi-definite \(p \times p\) "scale" matrix,
the matrix parameter of the distribution.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a numeric array, say <code>R</code>, of dimension \(p \times p \times n\),
    where each <code>R[,,i]</code> is a realization of the pseudo Wishart distribution
    \(W_p(Sigma, df)\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Diaz-Garcia, Jose A, Ramon Gutierrez Jaimez, and Kanti V Mardia. 1997.
“Wishart and Pseudo-Wishart Distributions and Some Applications to Shape Theory.”
Journal of Multivariate Analysis 63 (1): 73–87. 10.1006/jmva.1997.1689.</p>
<p>Bodnar, T.,  Mazur, S., Podgórski, K. "Singular inverse Wishart distribution and
its application to portfolio theory", Journal of Multivariate Analysis, Volume 143,
2016, Pages 314-326, ISSN 0047-259X,
10.1016/j.jmva.2015.09.021.</p>
<p>Bodnar, T.,  Okhrin, Y., "Properties of the singular, inverse
and generalized inverse partitioned Wishart distributions", Journal of
Multivariate Analysis, Volume 99, Issue 10, 2008,  Pages 2389-2405,
ISSN 0047-259X, 10.1016/j.jmva.2008.02.024.</p>
<p>Uhlig, Harald. On Singular Wishart and Singular Multivariate Beta Distributions.
Ann. Statist. 22 (1994), no. 1, 395--405. 10.1214/aos/1176325375.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/stats/topics/rWishart'>rWishart</a></code>, <code><a href='rInvWishart.html'>rInvWishart</a></code>,
    and <code><a href='rPseudoWishart.html'>rPseudoWishart</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>20181228</span>)
<span class='no'>A</span><span class='kw'>&lt;-</span><span class='fu'>rGenInvWishart</span>(<span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>5.0</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>5</span>))[,,<span class='fl'>1</span>]
<span class='no'>A</span></div><div class='output co'>#&gt;             [,1]         [,2]         [,3]         [,4]         [,5]
#&gt; [1,]  0.03316896 -0.084864096  0.003831550  0.031486573  0.060802330
#&gt; [2,] -0.08486410  0.265497148  0.003410527 -0.059750288 -0.159210057
#&gt; [3,]  0.00383155  0.003410527  0.025737818 -0.002461811  0.005335016
#&gt; [4,]  0.03148657 -0.059750288 -0.002461811  0.045360861  0.054727822
#&gt; [5,]  0.06080233 -0.159210057  0.005335016  0.054727822  0.139802644</div><div class='input'><span class='co'># A should be singular</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/eigen'>eigen</a></span>(<span class='no'>A</span>)$<span class='no'>values</span></div><div class='output co'>#&gt; [1]  4.227578e-01  4.247200e-02  2.813051e-02  1.620710e-02 -4.758659e-17</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>20181228</span>)
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rPseudoWishart.html'>rPseudoWishart</a></span>(<span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>5.0</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>5</span>))[,,<span class='fl'>1</span>]

<span class='co'># A should be a Moore-Penrose pseudo-inverse of B</span>
<span class='no'>B</span></div><div class='output co'>#&gt;            [,1]      [,2]      [,3]       [,4]       [,5]
#&gt; [1,]   6.855443 -1.979593  9.123138  12.366797 -10.283094
#&gt; [2,]  -1.979593 11.310039 -2.313472   1.767831  13.168709
#&gt; [3,]   9.123138 -2.313472 38.453046   1.981594  -8.875384
#&gt; [4,]  12.366797  1.767831  1.981594  33.137945 -16.467918
#&gt; [5,] -10.283094 13.168709 -8.875384 -16.467918  33.403804</div><div class='input'><span class='co'># this should be equal to B</span>
<span class='no'>B</span> <span class='kw'>%*%</span> <span class='no'>A</span> <span class='kw'>%*%</span> <span class='no'>B</span></div><div class='output co'>#&gt;            [,1]      [,2]      [,3]       [,4]       [,5]
#&gt; [1,]   6.855443 -1.979593  9.123138  12.366797 -10.283094
#&gt; [2,]  -1.979593 11.310039 -2.313472   1.767831  13.168709
#&gt; [3,]   9.123138 -2.313472 38.453046   1.981594  -8.875384
#&gt; [4,]  12.366797  1.767831  1.981594  33.137945 -16.467918
#&gt; [5,] -10.283094 13.168709 -8.875384 -16.467918  33.403804</div><div class='input'><span class='co'># this should be equal to A</span>
<span class='no'>A</span> <span class='kw'>%*%</span> <span class='no'>B</span> <span class='kw'>%*%</span> <span class='no'>A</span></div><div class='output co'>#&gt;             [,1]         [,2]         [,3]         [,4]         [,5]
#&gt; [1,]  0.03316896 -0.084864096  0.003831550  0.031486573  0.060802330
#&gt; [2,] -0.08486410  0.265497148  0.003410527 -0.059750288 -0.159210057
#&gt; [3,]  0.00383155  0.003410527  0.025737818 -0.002461811  0.005335016
#&gt; [4,]  0.03148657 -0.059750288 -0.002461811  0.045360861  0.054727822
#&gt; [5,]  0.06080233 -0.159210057  0.005335016  0.054727822  0.139802644</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

